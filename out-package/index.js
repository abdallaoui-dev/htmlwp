!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}(global,(function(){return function(){"use strict";var e={15:function(e){e.exports=require("html-minifier-terser")},136:function(e){e.exports=require("node:url")},203:function(e,t,r){var n=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,s=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return a},i=this&&this.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,i=0,s=t.length;i<s;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=s(r(896)),o=s(r(928)),c=function(){function e(e){this.name="FileBundler",this.initialFilePathName="",this.previousFilePathName="",this.filePathNames=new Set,this.fileCache=new Map,this.options=e,this.validateOptions(),this.name=(this.options.className||this.name).replace(/[^\w]/g,""),this.includePattern=new RegExp("(".concat(this.name,"\\.include)\\s*((\\.\\w+)|(\\(\\s*\"([\\\\\\/\\w\\-\\.\\:\\~\\s]+)\"\\s*\\))|(\\(\\s*'([\\\\\\/\\w\\-\\.\\:\\~\\s]+)'\\s*\\))|(\\(\\s*`([\\\\\\/\\w\\-\\.\\:\\~\\s]+)`\\s*\\)))(\\s*;)?"),"gi"),this.importPattern=new RegExp("(@?import)\\s*((\"([\\\\\\/\\w\\-\\.\\:\\~\\s]+)\")|('([\\\\\\/\\w\\-\\.\\:\\~\\s]+)')|(`([\\\\\\/\\w\\-\\.\\:\\~\\s]+)`))(\\s*;)?","gi"),this.pattern="@?import"===this.options.pattern?this.importPattern:this.includePattern}return e.prototype.validateOptions=function(){for(var e in this.options.className="string"==typeof this.options.className?this.options.className:"",this.isObjectLiteral(this.options.includeProperties)||(this.options.includeProperties={}),this.options.includeProperties)"string"!=typeof this.options.includeProperties[e]&&delete this.options.includeProperties[e]},e.prototype.isObjectLiteral=function(e){return"object"==typeof e&&null!==e&&"[object Object]"===String(e)},e.prototype.readFileSyncCached=function(e){return this.fileCache.has(e)||this.fileCache.set(e,a.default.readFileSync(e,"utf-8")),this.fileCache.get(e)},e.prototype.replace=function(e){var t=this;try{if("string"!=typeof e)throw new Error("Invalid filePathName");var r="";return e=o.default.resolve(o.default.dirname(this.previousFilePathName||this.initialFilePathName),e.replace(/^[\\\/]*/g,"")),this.initialFilePathName!==e&&(r=this.readFileSyncCached(e),this.filePathNames.add(e)),this.initialFilePathName||(this.initialFilePathName=e),{source:r=r.replace(this.pattern,(function(r,n,i){if(!i)throw new Error("Regex capture failed");if(i.startsWith("."))return i=i.replace(/\./g,""),t.getPropertyValue(i)||"".concat(t.name," Exception:\n").concat("*".repeat(10)," ERROR: Property '").concat(i,"' not found in includeProperties ").concat("*".repeat(10));if(i.match(/^["'`(]/)){var s=i.replace(/['"`()]+/g,""),a=o.default.extname(t.initialFilePathName);return o.default.extname(s)||(s+=a),t.previousFilePathName=e,t.replace(s).source}return r})),filePathNames:i([],n(this.filePathNames),!1)}}catch(e){var s=e;return this.logError(s),{source:(null==s?void 0:s.message)?"".concat(this.name," Exception:\n").concat("*".repeat(10)," ").concat(s.message," ").concat("*".repeat(10)):"".concat(this.name," ERROR: check console"),filePathNames:[]}}},e.prototype.getPropertyValue=function(e){return this.isObjectLiteral(this.options.includeProperties)&&this.options.includeProperties[e]||null},e.prototype.bundle=function(e){return this.getFinalResults(e)},e.prototype.bundleAsync=function(e){return Promise.resolve(this.getFinalResults(e))},e.prototype.getFinalResults=function(e){var t=this.replace(e);return this.initialFilePathName="",this.previousFilePathName="",this.filePathNames.clear(),this.fileCache.clear(),t},e.prototype.logError=function(e){console.log("[31m[1m","".concat(this.name," Exception:\n"),String(e),"[0m")},e}();t.default=c},260:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,s){function a(e){try{c(n.next(e))}catch(e){s(e)}}function o(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,o)}c((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,i,s,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(o){return function(c){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,o[0]&&(a=0)),a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},s=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,s=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return a},o=this&&this.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,i=0,s=t.length;i<s;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=c(r(455)),l=c(r(760)),h=c(r(136)),p=c(r(598)),f=c(r(15)),d=c(r(878)),m=c(r(817)),y=c(r(872)),v=c(r(203));t.default=function(e){var t=this;this.className="Htmlwp",this.name=this.className,this.watchedDependencies=new Map,this.cssOutputPaths=new Map,this.isProductionMode=!1,this.apply=function(e){t.logger=e.getInfrastructureLogger(t.name),e.hooks.done.tapAsync(t.name,(function(e,r){return n(t,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return this.stats=e,this.isProductionMode="production"===this.stats.compilation.compiler.options.mode,[4,this.handleExternalAssets()];case 1:return t.sent(),e.compilation.fileDependencies.addAll(Array.from(this.watchedDependencies.values()).flat()),r(),[2]}}))}))}))},this.handleExternalAssets=function(){return n(t,void 0,void 0,(function(){var e,t,r,n,o,c,u,l,h,p,f,d,m,y,v;return i(this,(function(i){switch(i.label){case 0:if(i.trys.push([0,15,,16]),!(e=this.getFirstModifiedFile()))return[3,9];i.label=1;case 1:i.trys.push([1,6,7,8]),t=s(this.watchedDependencies),r=t.next(),i.label=2;case 2:return r.done?[3,5]:(n=a(r.value,2),o=n[0],n[1].includes(e)?[4,this.processEntries(o)]:[3,4]);case 3:i.sent(),i.label=4;case 4:return r=t.next(),[3,2];case 5:return[3,8];case 6:return c=i.sent(),y={error:c},[3,8];case 7:try{r&&!r.done&&(v=t.return)&&v.call(t)}finally{if(y)throw y.error}return[7];case 8:return[2];case 9:for(h in u=this.options.entry,l=[],u)l.push(h);p=0,i.label=10;case 10:return p<l.length?(h=l[p])in u?(f=h,"srcPath"in(d=this.options.entry[f])&&d.destPath?[4,this.copyAssets(d.srcPath,d.destPath)]:[3,12]):[3,12]:[3,13];case 11:i.sent(),i.label=12;case 12:return p++,[3,10];case 13:return[4,this.processEntries()];case 14:return i.sent(),[3,16];case 15:return m=i.sent(),this.logger.error(m),[3,16];case 16:return[2]}}))}))},this.processEntries=function(e){return n(t,void 0,void 0,(function(){var t,r,n,s,a,o,c,u,l,h,p;return i(this,(function(i){switch(i.label){case 0:for(o in(t=this.options.entry.global)&&t.import&&(t=void 0),r=!1,n=[],s=this.options.entry,a=[],s)a.push(o);c=0,i.label=1;case 1:if(!(c<a.length))return[3,10];if(!((o=a[c])in s))return[3,9];if(u=o,"srcPath"in(l=this.options.entry[u]))return[3,9];if(!Array.isArray(l.styles))return[3,7];h=0,i.label=2;case 2:return h<l.styles.length?(p=l.styles[h],r||!this.stats.compilation.outputOptions.clean?[3,4]:[4,this.cleanCssFiles(p.filename)]):[3,7];case 3:i.sent(),r=!0,i.label=4;case 4:return e&&p.import!==e?[3,6]:[4,this.bundleCss(p)];case 5:if(i.sent(),e)return[3,10];i.label=6;case 6:return h++,[3,2];case 7:return l.import&&l.filename?e&&e!==l.import?[3,9]:[4,this.bundleHtml(l,t)]:[3,9];case 8:if(i.sent(),n.push(l.filename),e)return[3,10];i.label=9;case 9:return c++,[3,1];case 10:return!e&&this.isProductionMode&&this.options.xmlsitemap?[4,this.generateXmlSitemap(n)]:[3,12];case 11:i.sent(),i.label=12;case 12:return[2]}}))}))},this.cleanCssFiles=function(e){return n(t,void 0,void 0,(function(){var t;return i(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),t=l.default.dirname(l.default.join(this.getOutputPath(),e)),[4,u.default.rm(t,{recursive:!0})];case 1:case 2:return r.sent(),[3,3];case 3:return[2]}}))}))},this.bundleHtml=function(e,r){return n(t,void 0,void 0,(function(){var t;return i(this,(function(n){switch(n.label){case 0:return t=this.includer.bundle(e.import),this.isProductionMode?[4,this.minify(t)]:[3,2];case 1:n.sent(),n.label=2;case 2:return r&&Array.isArray(r.styles)&&this.injectLinkTags(t,r.styles),Array.isArray(e.styles)&&this.injectLinkTags(t,e.styles),r&&Array.isArray(r.jschunks)&&this.injectScriptTags(t,r.jschunks),Array.isArray(e.jschunks)&&this.injectScriptTags(t,e.jschunks),this.watchedDependencies.set(e.import,t.filePathNames),[4,this.output(e.filename,t)];case 3:return n.sent(),[2]}}))}))},this.injectLinkTags=function(e,r){var n,i,a="";try{for(var o=s(r),c=o.next();!c.done;c=o.next()){var u=c.value,l=("/"+(t.cssOutputPaths.get(u.import)||u.filename)).replace(/[\\/]+/g,"/");a+='<link rel="stylesheet" href="'.concat(l,'">')}}catch(e){n={error:e}}finally{try{c&&!c.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}e.source=e.source.replace(/<\/head>/,a+"</head>")},this.injectScriptTags=function(e,r){var n,i,c,u,l=new Map;try{for(var h=s(r),p=h.next();!p.done;p=h.next()){var f=p.value,d=t.stats.compilation.namedChunks.get(f.name);if(d){var m=("/"+o([],a(d.files),!1)[0]).replace(/[\\/]+/g,"/"),y=Object.entries(f.attributes||{}).map((function(e){var t=a(e,2),r=t[0],n=t[1];return"string"==typeof n?"".concat(r,'="').concat(n,'"'):r})).join(" "),v="<script ".concat(y,' src="').concat(m,'"><\/script>').replace(/\s+/g," "),g=f.inject||"body";l.set(g,(l.get(g)||"")+v)}}}catch(e){n={error:e}}finally{try{p&&!p.done&&(i=h.return)&&i.call(h)}finally{if(n)throw n.error}}try{for(var b=s(l),w=b.next();!w.done;w=b.next()){var P=a(w.value,2),x=(g=P[0],P[1]);if("head"===g)e.source=e.source.replace(/<\/head>/,x+"</head>");else{var N=e.source.lastIndexOf("</body>");if(-1===N)continue;e.source=e.source.slice(0,N)+x+e.source.slice(N)}}}catch(e){c={error:e}}finally{try{w&&!w.done&&(u=b.return)&&u.call(b)}finally{if(c)throw c.error}}},this.bundleCss=function(e){return n(t,void 0,void 0,(function(){var t,r,n,s,a;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),t=d.default.compile(e.import,{style:this.isProductionMode?"compressed":void 0,alertColor:!1}),r={source:t.css,filePathNames:t.loadedUrls.map((function(e){return h.default.fileURLToPath(e.href)}))},this.isProductionMode&&(r.source=(0,m.default)([y.default]).process(r.source,{from:void 0}).css),(n=e.filename).includes("[contenthash]")&&(s=p.default.createHash("md5").update(r.source).digest("hex").slice(0,24),n=n.replace("[contenthash]",s),this.cssOutputPaths.set(e.import,n)),this.watchedDependencies.set(e.import,r.filePathNames),[4,this.output(n,r)];case 1:return i.sent(),[3,3];case 2:return a=i.sent(),this.logger.error("".concat(this.className,".bundleCss: "),a),[3,3];case 3:return[2]}}))}))},this.copyAssets=function(e,r){return n(t,void 0,void 0,(function(){var t,s,a,o,c=this;return i(this,(function(h){switch(h.label){case 0:return h.trys.push([0,4,,5]),t=this.getOutputPath(),s=l.default.join(t,r),[4,this.ensureDirExists(s)];case 1:return h.sent(),[4,u.default.readdir(e)];case 2:return a=h.sent(),[4,Promise.all(a.map((function(t){return n(c,void 0,void 0,(function(){var r,n,a,o,c;return i(this,(function(i){switch(i.label){case 0:return r=l.default.join(e,t),n=l.default.join(s,t),[4,u.default.stat(r)];case 1:return i.sent().isDirectory()?[4,this.copyAssets(r,n)]:[3,3];case 2:return i.sent(),[3,8];case 3:return t.endsWith(".json")&&this.isProductionMode?(c=(o=JSON).parse,[4,u.default.readFile(r,"utf8")]):[3,6];case 4:return a=c.apply(o,[i.sent()]),[4,u.default.writeFile(n,JSON.stringify(a),"utf8")];case 5:return i.sent(),[3,8];case 6:return[4,u.default.copyFile(r,n)];case 7:i.sent(),i.label=8;case 8:return[2]}}))}))})))];case 3:return h.sent(),[3,5];case 4:return o=h.sent(),this.logger.error(o),[3,5];case 5:return[2]}}))}))},this.getFirstModifiedFile=function(){var e=t.stats.compilation.compiler.modifiedFiles;return e&&o([],a(e),!1)[0]||null},this.minify=function(e){return n(t,void 0,void 0,(function(){var t,r;return i(this,(function(n){switch(n.label){case 0:return t=this.options.htmlMinifyOptions||{removeComments:!0,removeScriptTypeAttributes:!0,removeStyleLinkTypeAttributes:!0,removeRedundantAttributes:!0,collapseWhitespace:!0,keepClosingSlash:!0,useShortDoctype:!0,minifyCSS:!0,minifyJS:!0},r=e,[4,f.default.minify(e.source,t)];case 1:return r.source=n.sent(),[2]}}))}))},this.output=function(e,r){return n(t,void 0,void 0,(function(){var t,n,s,a;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),t=this.getOutputPath(),n=l.default.join(t,e),s=l.default.dirname(n),[4,this.ensureDirExists(s)];case 1:return i.sent(),[4,u.default.writeFile(n,r.source)];case 2:return i.sent(),[3,4];case 3:return a=i.sent(),this.logger.error(a),[3,4];case 4:return[2]}}))}))},this.getOutputPath=function(){return t.options.outputPath||t.stats.compilation.outputOptions.path||"dist"},this.fileExists=function(e){return n(t,void 0,void 0,(function(){var t;return i(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,u.default.access(e)];case 1:return r.sent(),[2,!0];case 2:if("ENOENT"===(t=r.sent()).code)return[2,!1];throw t;case 3:return[2]}}))}))},this.ensureDirExists=function(e){return n(t,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,this.fileExists(e)];case 1:return t.sent()?[3,3]:[4,u.default.mkdir(e,{recursive:!0})];case 2:t.sent(),t.label=3;case 3:return[2]}}))}))},this.generateXmlSitemap=function(e){return n(t,void 0,void 0,(function(){var t,r,n,s,a,o,c,u,l,h,p=this;return i(this,(function(i){switch(i.label){case 0:return(t=this.options.xmlsitemap)?(r=t.originUrl,n=t.lastmod,s=t.exclude,a=void 0===s?[]:s,o=t.include,r.startsWith("http")||this.logger.warn("sitemap original should start with http/https"),r=r.replace(/\/$/,""),n="current"===n?(new Date).toISOString().split("T")[0]:n,c=e.filter((function(e){return e.endsWith(".html")})).map((function(e){var t=e.replace(/\\/g,"/").replace(/^index\.html$/,"").replace(/\/index\.html$/,"/");return"".concat(r,"/").concat(t.replace(/^\//,""))})),o?c=o.map((function(e){return r+"/"+e.replace(/^\//,"")})):a.length>0&&(u=a.map((function(e){return new RegExp(e)})),c=c.filter((function(e){return!u.some((function(t){return t.test(e)}))}))),0===(l=c.map((function(e){var t=n?"<lastmod>".concat(n,"</lastmod>"):"";return"<url><loc>".concat(p.escapeXml(e),"</loc>").concat(t,"</url>")})).join("")).length?[2]:(h='<?xml version="1.0" encoding="UTF-8"?><urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">'.concat(l,"</urlset>"),[4,this.output("sitemap.xml",{source:h,filePathNames:[]})])):[2];case 1:return i.sent(),[2]}}))}))},this.escapeXml=function(e){return e.replace(/[&<>"']/g,(function(e){return{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;"}[e]||e}))},this.options=e,this.includer=new v.default({className:this.options.htmlIncludePrefixName||this.name,pattern:"include",includeProperties:this.options.htmlIncludeProperties})}},455:function(e){e.exports=require("node:fs/promises")},598:function(e){e.exports=require("node:crypto")},760:function(e){e.exports=require("node:path")},817:function(e){e.exports=require("postcss")},872:function(e){e.exports=require("autoprefixer")},878:function(e){e.exports=require("sass")},896:function(e){e.exports=require("fs")},928:function(e){e.exports=require("path")}},t={},r=function r(n){var i=t[n];if(void 0!==i)return i.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,r),s.exports}(260);return r.default}()}));